<!DOCTYPE html>
<html lang="en">
  <head>
     
  <link rel="stylesheet" type="text/css" href="style.css">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- The line below is responsive to the screen size -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title> Genre Classifier </title>
    <!-- Bootstrap -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <script src="https://use.fontawesome.com/87382e673b.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-91864151-2', 'auto');
  ga('send', 'pageview');

</script>
  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top" id="my-navbar">
      <div class="container">
        <div class="navbar-header">
          <a href="" class="navbar-brand">Genre Classifier</a>
        </div><!-- Navbar Header-->
        <div class="collapse navbar-collapse" id="navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="#Overview">Overview</a></li>
            <li><a href="#Methodology">Methodology</a></li>
            <li><a href="#Results">Results</a></li>
            <li><a href="#Conclusion">Conclusion</a></li>

          </ul>
        </div><!-- End navbar body-->
      </div><!-- End container-->
    </nav><!-- End top navbar-->
    
    <div class="container">
      <div class="jumbotron">
        <div class="container text-center">
          <h2>Genre Classifier</h2>
          <h4><a href="http://cs.northwestern.edu/~pardo/courses/eecs352/index.php" target="_blank">Northwestern University EECS 352</a> with <a href="http://www.bryanpardo.com" target="_blank"> Professor Bryan Pardo </a> </h4>
         </div>
        <div class="row text-center">
          <div class="col-md-4">
            <h5>Nick David</br>nicholasdavid2019@u.northwestern.edu</h5> 
          </div>
          <div class="col-md-4">
            <h5>Yichun Li</br>yichunli2019@u.northwestern.edu</h5>
          </div>
          <div class="col-md-4">
            <h5>Zilun Yu</br>zilunyu2019@u.nortwhestern.edu</h5>
          </div>
        </div> 
      </div><!-- End jumbotron-->
    </div><!-- End container -->

    <div class="container" id="Overview">
      <h4 class="text-left">Overview</h4>
        After the boom of music streaming business and the ability for anyone to upload their own songs to YouTube and SoundCloud, the music library for providers such as iTunes, Spotify and Pandora has increasingly expanded in a faster and larger scale. As part of the service, all songs provided to the users contain many tags and genre is one of them. It is a common way for music service to personalize and make the music experiences better for each user.
        <br>
        <br>
Therefore, genre classification has been a well-studied topic over the past decade. Our goal is to design a program that can take an audio file as input and return its best estimation for the genre of the inputted audio file. We think that by further exploring the low-level mechanisms that goes into genre classification will help us understand which features of audio files are best for classifying Western music in general.
        <br>
        <br>
        We are trying to develop and compare the accuracy of our KNN classifier based on different sets of features. In detail, we are trying to find the feature vector that comprises of the low-level features that will generate the most accurate results of genre classification.


    </div><!-- End container-->
    
    <div class="container" id="Methodology">
      <h4 class="text-left">Methodology</h4>
        Genre classification is centered around machine learning. Therefore, we choose, for this project, the k-nearest neighbors algorithm (KNN)  for doing the job. In addition, it is very crucial to determine the genres that we are classifying the music into and the dataset that we are training our algorithm on. We chose <a href="http://marsyasweb.appspot.com/download/data_sets/" target="_blank"> GTZAN Genre Collection Dataset. </a>There are 1,000 songs of 30 seconds each in .wav format, evenly distributed into 10 genres. The 10 different genres are: 
<ul>
        <li> Blues</li>
    <li> Classical</li>
        <li> Country</li>
    <li> Disco</li>
        <li> Hip-Hop</li>
    <li> Jazz</li>
    <li> Metal </li>
    <li> Pop</li>
    <li> Raggae</li>
    <li> Rock</li>
        </ul> <br>
        Below are examples of one audio file for each genre: ( .WAV files do not play in Chrome)  <br>
        Blues: 
        <audio controls>
  <source src="media/samplesongs/blues.00092.wav" type="audio/wav">
Your browser does not support the audio element. Please get a new browser!
</audio> <br>
         Classical: 
        <audio controls>
  <source src="media/samplesongs/classical.00038.wav" type="audio/wav">
Your browser does not support the audio element. Please get a new browser!
</audio> <br>
         Country: 
        <audio controls>
  <source src="media/samplesongs/country.00077.wav" type="audio/wav">
Your browser does not support the audio element. Please get a new browser!
</audio> <br>
         Disco: 
        <audio controls>
  <source src="media/samplesongs/disco.00014.wav" type="audio/wav">
Your browser does not support the audio element. Please get a new browser!
</audio> <br>
               Hip-Hop: 
        <audio controls>
  <source src="media/samplesongs/hiphop.00029.wav" type="audio/wav">
Your browser does not support the audio element. Please get a new browser!
</audio> <br>
               Jazz: 
        <audio controls>
  <source src="media/samplesongs/jazz.00022.wav" type="audio/wav">
Your browser does not support the audio element. Please get a new browser!
</audio> <br>
               Metal: 
        <audio controls>
  <source src="media/samplesongs/metal.00011.wav" type="audio/wav">
Your browser does not support the audio element. Please get a new browser!
</audio> <br>
               Pop: 
        <audio controls>
  <source src="media/samplesongs/pop.00027.wav" type="audio/wav">
Your browser does not support the audio element. Please get a new browser!
</audio> <br>
         Reggae: 
        <audio controls>
            <source src="media/samplesongs/reggae.00040.wav" type="audio/wav"> </audio> <br>
             Rock: 
        <audio controls>
  <source src="media/samplesongs/rock.00048.wav" type="audio/wav">
            
Your browser does not support the audio element. Please get a new browser!
</audio> <br>
        <b>Feature Extraction</b>
        <br>
        Afterwards, we used an <a href = "https://github.com/danz1ka19/Music-Emotion-Recognition/blob/master/Feature-Extraction.py" target="_blank">existing script</a> online to conduct feature extraction. The script uses Librosa to extract the packages. It takes in audio files and output a .csv file that lists the final values of each feature for each song. Each song has 39 fields, among them ‘Song Name’ and ‘Genre’.
        <br>
        <br>
        While reviewing the results, we find out that among features, the range of values vary drastically. Therefore, we decided to normalize all data to prevent potential skews while running through the KNN classifier. We modified the pre-existing code to normalize the data before it exports it to a .CSV. Our version of the code that extracts only the features we used and normalizes the data along with an example output can be found here <a href="export/exampleoutput.zip"> (.Zip).</a> The equation for normalization is shown below: 
        <br> <br> 
        <img src="media/equation.png" alt="equation">
<br>
        <br>
        <b> Classification</b>
        <br>
        <br>
        The k-nearest neighbors algorithm (KNN) takes an input of two .csv files:
        <br>
        <ul>
        <li> Training .csv: a matrix of the individual songs versus the values of all extracted features.
            </li>
            <li> Testing .csv: a matrix of the individual songs versus the labelled genres.
            </li>
        </ul>
        Each song is passed into the matrix as a feature vector of 37 fields. The 37 features maps into three high-level features: rhythm, timbre and harmony.
<br> <br> Each file has all 1000 songs in them. The songs are not randomized and grouped in terms of genres. <br> <br>
        We determined that we are going to split the datasets into two: 800 songs for training and 200 songs for testing. The KNN algorithm divides the files into corresponding portions for its training and testing.  In other words, each genre has 80 songs used for training the model and 20 songs used for testing the model.
<br> <br>
        <b> Evaluation</b> <br> <br>
            	The output of KNN matrix is used for evaluation of the algorithm. The vector of genre classification results, which in our case 200 of them, is made into a confusion matrix. The matrix describes the performance of the classifier in terms of how many songs that are correctly classified and how many are not. For the confusion matrix, we also calculated the hit rates overall genre classification and that of each genre.

    </div><!-- End container--> 

    <div class="container" id="Results">
      <h4 class="text-left">Results</h4>
        <br>
        We ran the KNN classifier based on our dataset setup and we had a 54.50% hit rate.  For individual genres, the hit rate ranges from as low as 5% for Rock and as high as 90% for Classical. <br> <br>
        For individual genres, the classifier did well on genres of classical and pop; <br>
The classifier did okay in country, disco and metal; <br>
The classifier did poorly in blues, hiphop, jazz, reggae and rock. <br>
        <ul> 
        <li> Blues songs are most often classified incorrectly into disco and rock.
</li>
            <li> Hiphop songs are most often classified incorrectly into disco and pop.
</li>
            <li> Jazz songs are most often classified incorrectly into country, disco and reggae.
</li>
            <li> Reggae songs are most often classified incorrectly into disco.
</li> 
            <li> Rock songs are most often classified incorrectly into country, disco and reggae.</li>
        </ul>
<br> In addition, disco, jazz, reggae and rock are the most popular genres that the songs were classified incorrectly into.
<br> <br>
        <b> Confusion Matrix for 800 train, 200 test</b> <br> Vertical Axis is Actual Genre, Horizontial Axis is Predicted Genre <br>
        <br> <img src="media/800,800.png" alt="800,200" style="width:735px"> <br>

<br>
<b> Subsequent Testing </b>
        <br> <br>
        First of all, we changed our setup to test for a better result: we train the model on 800 songs and test the data on the 800 songs itself to see if the model gives us a better result. The result, as it turns out, is better. However, the results mirrored the hit rates of genres for our original setup. This means that there might be an incorrect setup of our feature vectors.
<br> <br>
        <b> Confusion Matrix for 800 train, 800 test</b> <br> Vertical Axis is Actual Genre, Horizontial Axis is Predicted Genre <br>
        <br> <img src="media/800,200.png" alt="800,800" style="width:735px"> <br> <br> 
        We had a hypothesis on why the classifier does poorly: <u> we have too many features that potentially caused interference and a dampening effect when KNN is running the classification.</u> Therefore, we decided to run the KNN algorithm again with fewer features. 
<br> <br>
        We did further data analysis on our current dataset. We calculated the mean and standard deviation for each feature of each genre group. From them, we eyeballed to pick the features for our new feature vector with a smaller dimension under the two conditions:
        <ul>
        <li> For a feature, the averages are visibly distinct among the genres.</li>
            <li> For a feature, the standard deviation should be comparatively small in all genres.
</li>
            <li> The features should represent all three of our high-level features
</li> 
        </ul>
        In this way, we think that such process would be able to find features that better represent the genres and also differentiable.
<br>After a few runs, we found out that a new feature vector of 11 features give us a marginally better accuracy. The new overall hit rate is 55%. <br> <br>
        <b> Graphs: </b> <br> <br>
        Graph 1: Compraing running 37-Feature KNN with 800 songs to train, 200 seperate to test vs 800 songs to train, same 800 to test: <br>
        <img src="media/graph1.png" alt="KNN 800 vs 200 testing 37 feat" style="width:735px">
        <br>
        Graph 2: Comparing 37 feature KNN with 800 songs to train, 200 seperate to test vs 11 Feature KNN with 800 songs to train, 200 seperate to test:
        <br>
        <img src="media/graph2.png" alt="KNN 37 feature vs 11 feautre" style="width:735px">



    </div><!-- End container-->

    <div class="container" id="Conclusion">
      <h4 class="text-left">Conclusion</h4>
        <p> Based on the subsequent testing, we determined that our hypothesis is proved to be wrong. However, we think that there are the following things that potentially caused the results and we could improve upon given more time:</p>
            <ol> 
        <li> <p> “Fewer Features”. Given more time, we might be able to use more sophisticated data analysis instead of mere eyeballing. Using the results from the analysis, we will be able to pick features that best correlate with classification of the genres that we are testing on.  
</p></li>
                <li> <p> “More Features”. Further, we have a theory that the results might not be enough in the sense of mapping into high-level features. Based on librosa that our feature extraction script is using, the 37 features are heavily tilted towards the timbre feature group. Therefore, by using other, more comprehensive packages, such as Essentia (another music and audio processing package in Python), we will be able to extract more features for the rhythm and harmony feature group, and potentially other high-level feature group such as pitch and complexity. In that way, by evenly distributing the weight for each feature group in the feature vector, we could potentially acquire better results.
</p></li>
                <li> <p> The capacity of the dataset used for training. We only have 1,000 songs in our dataset, with 800 used for training and 200 used for testing. With a dataset of a bigger size, such as 10,000 songs, we might be able to train the KNN algorithm to do a better job.
</p></li>
                <li> <p> The defined genres. The current genres that we are using might not be accurate enough. For example, disco is a genre that is quite antique and not representative enough of the music in the present. Genres such as blues and jazz, metal and rock, could debatably be thought as similar genres or one being a subgenre of the other.  A better definition of the genres could help us in getting a more accurate result.</p></li>
                <li> <p> Comparison to humans: We have identified the percentages at which our program and KNN can identify genres at, but in order to truly understand how powerful our solution is, we must perform a study on how accurate humans can identify genres. Will humans be more accurate? If so how long does it take them and is the extra accuracy worth the labor cost associated with it? Performing a study comparing a test data set done on humans, and done on our system would be an ideal step. </p></li>
        </ol>
        <br>
        <br>
        <br>
        <br>
        <br>
        
    </div><!-- End container-->


    <footer>
      <div class="navbar navbar-default navbar-fixed-bottom">
        <div class="container">
              <div class="navbar-collapse collapse" id="footer-body">
                  <ul class="nav navbar-nav">
                      <li><a href="Poster-PDF.pdf"  target="_blank"> <center> <figure>  <img src="footer-icons/poster.png" style="width:35px" </img> <figcaption>Poster(.PDF) </figcaption> </figure> </center></a></li>
                  <li><a href="rawdata.csv" download target="_blank"> <center> <figure>  <img src="footer-icons/rawdata.png" style="width:35px" </img> <figcaption>Raw Feature Data (.CSV) </figcaption> </figure> </center></a></li>
                         <li><a href="https://github.com/NickDavidNU/Genre-Classifier/tree/master "  target="_blank"> <center> <figure>  <img src="footer-icons/github.png" style="width:35px" </img> <figcaption>Project GitHub </figcaption> </figure> </center></a></li>
                      
                
                  </ul>
              </div>
          </div>
      </div>
   </footer> 
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  </body>
</html>
