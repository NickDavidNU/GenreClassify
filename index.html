<!DOCTYPE html>
<html lang="en">
  <head>
      <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <link rel="stylesheet" type="text/css" href="style.css">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- The line below is responsive to the screen size -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title> Genre Classifier </title>
    <!-- Bootstrap -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <script src="https://use.fontawesome.com/87382e673b.js"></script>
      <script src="graph.js" type="text/javascript"></script>
      
  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top" id="my-navbar">
      <div class="container">
        <div class="navbar-header">
          <a href="" class="navbar-brand">Genre Classifier</a>
        </div><!-- Navbar Header-->
        <div class="collapse navbar-collapse" id="navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="#Overview">Overview</a></li>
            <li><a href="#Methodology">Methodology</a></li>
            <li><a href="#Results">Results</a></li>
            <li><a href="#Conclusion">Conclusion</a></li>

          </ul>
        </div><!-- End navbar body-->
      </div><!-- End container-->
    </nav><!-- End top navbar-->
    
    <div class="container">
      <div class="jumbotron">
        <div class="container text-center">
          <h2>Genre Classifier</h2>
          <h4><a href="http://cs.northwestern.edu/~pardo/courses/eecs352/index.php">Northwestern University EECS 352</a> with <a href="http://www.bryanpardo.com"> Professor Bryan Pardo </a> </h4>
         </div>
        <div class="row text-center">
          <div class="col-md-4">
            <h5>Nick David</br>nicholasdavid2019@u.northwestern.edu</h5> 
          </div>
          <div class="col-md-4">
            <h5>Yichun Li</br>yichunli2019@u.northwestern.edu</h5>
          </div>
          <div class="col-md-4">
            <h5>Zilun Yu</br>zilunyu2019@u.nortwhestern.edu</h5>
          </div>
        </div> 
      </div><!-- End jumbotron-->
    </div><!-- End container -->

    <div class="container" id="Overview">
      <h4 class="text-left">Overview</h4>
        After the boom of music streaming business and the ability for anyone to upload their own songs to YouTube and SoundCloud, the music library for providers such as iTunes, Spotify and Pandora has increasingly expanded in a faster and larger scale. As part of the service, all songs provided to the users contain many tags and genre is one of them. It is a common way for music service to personalize and make the music experiences better for each user.
        <br>
        <br>
Therefore, genre classification has been a well-studied topic over the past decade. Our goal is to design a program that can take an audio file as input and return its best estimation for the genre of the inputted audio file. We think that by further exploring the low-level mechanisms that goes into genre classification will help us understand which features of audio files are best for classifying Western music in general.
        <br>
        <br>
        We are trying to develop and compare the accuracy of our KNN classifier based on different sets of features. In detail, we are trying to find the feature vector that comprises of the low-level features that will generate the most accurate results of genre classification.


    </div><!-- End container-->
    
    <div class="container" id="Methodology">
      <h4 class="text-left">Methodology</h4>
        Genre classification is centered around machine learning. Therefore, we choose, for this project, the k-nearest neighbors algorithm (KNN)  for doing the job. In addition, it is very crucial to determine the genres that we are classifying the music into and the dataset that we are training our algorithm on. We chose GTZAN Genre Collection Dataset. There are 1,000 songs of 30 seconds each in .wav format, evenly distributed into 10 genres. The 10 different genres are: 
<ul>
        <li> Blues</li>
    <li> Classical</li>
        <li> Country</li>
    <li> Disco</li>
        <li> Hip-Hop</li>
    <li> Jazz</li>
    <li> Metal </li>
    <li> Pop</li>
    <li> Raggae</li>
    <li> Rock</li>
        </ul>
        <b>Feature Extraction</b>
        <br>
        Afterwards, we used an <a href = "https://github.com/danz1ka19/Music-Emotion-Recognition/blob/master/Feature-Extraction.py">existing script</a> online to conduct feature extraction. The script uses Librosa to extract the packages. It takes in audio files and output a .csv file that lists the final values of each feature for each song. Each song has 39 fields, among them ‘Song Name’ and ‘Genre’.
        <br>
        <br>
        While reviewing the results, we find out that among features, the range of values vary drastically. Therefore, we decided to normalize all data to prevent potential skews while running through the KNN classifier. We modified the pre-existing code to normalize the data before it exports it to a .CSV. Our version of the code that extracts only the features we used and normalizes the data along with an example output can be found here <a href="export/exampleoutput.zip"> (.Zip).</a>
<br>
        <br>
        <b> Classification</b>
        <br>
        <br>
        The k-nearest neighbors algorithm (KNN) takes an input of two .csv files:
        <br>
        <ul>
        <li> Training .csv: a matrix of the individual songs versus the values of all extracted features.
            </li>
            <li> Testing .csv: a matrix of the individual songs versus the labelled genres.
            </li>
        </ul>
        Each song is passed into the matrix as a feature vector of 37 fields. The 37 features maps into three high-level features: rhythm, timbre and harmony.
<br> <br> Each file has all 1000 songs in them. The songs are not randomized and grouped in terms of genres. <br> <br>
        We determined that we are going to split the datasets into two: 800 songs for training and 200 songs for testing. The KNN algorithm divides the files into corresponding portions for its training and testing.  In other words, each genre has 80 songs used for training the model and 20 songs used for testing the model.
<br> <br>
        <b> Evaluation</b> <br> <br>
            	The output of KNN matrix is used for evaluation of the algorithm. The vector of genre classification results, which in our case 200 of them, is made into a confusion matrix. The matrix describes the performance of the classifier in terms of how many songs that are correctly classified and how many are not. For the confusion matrix, we also calculated the hit rates overall genre classification and that of each genre.

    </div><!-- End container--> 

    <div class="container" id="Results">
      <h4 class="text-left">Results</h4>
        <br> <br>
        We ran the KNN classifier based on our dataset setup and we had a 54.50% hit rate.  For individual genres, the hit rate ranges from as low as 5% for Rock and as high as 90% for Classical. <br> <br>
        For individual genres, the classifier did well on genres of classical and pop; <br>
The classifier did okay in country, disco and metal; <br>
The classifier did poorly in blues, hiphop, jazz, reggae and rock. <br>
        <ul> 
        <li> Blues songs are most often classified incorrectly into disco and rock.
</li>
            <li> Hiphop songs are most often classified incorrectly into disco and pop.
</li>
            <li> Jazz songs are most often classified incorrectly into country, disco and reggae.
</li>
            <li> Reggae songs are most often classified incorrectly into disco.
</li> 
            <li> Rock songs are most often classified incorrectly into country, disco and reggae.</li>
        </ul>
<br> In addition, disco, jazz, reggae and rock are the most popular genres that the songs were classified incorrectly into.
<br>
<br>
<b> Subsequent Testing </b>
        <br>
        First of all, we changed our setup to test for a better result: we train the model on 800 songs and test the data on the 800 songs itself to see if the model gives us a better result. The result, as it turns out, is better. However, the results mirrored the hit rates of genres for our original setup. This means that there might be an incorrect setup of our feature vectors.
<br> <br>
        We had a hypothesis on why the classifier does poorly: <u> we have too many features that potentially caused interference and a dampening effect when KNN is running the classification.</u> Therefore, we decided to run the KNN algorithm again with fewer features. 
<br> <br>
        We did further data analysis on our current dataset. We calculated the mean and standard deviation for each feature of each genre group. From them, we eyeballed to pick the features for our new feature vector with a smaller dimension under the two conditions:
        <ul>
        <li> For a feature, the averages are visibly distinct among the genres.</li>
            <li> For a feature, the standard deviation should be comparatively small in all genres.
</li>
            <li> The features should represent all three of our high-level features
</li> 
        </ul>
        In this way, we think that such process would be able to find features that better represent the genres and also differentiable.
<br>After a few runs, we found out that a new feature vector of 11 features give us a marginally better accuracy. The new overall hit rate is 55%.




    </div><!-- End container-->

    <div class="container" id="Conclusion">
      <h4 class="text-left">Conclusion</h4>
        <br>
        
    </div><!-- End container-->


    <footer>
      <div class="navbar navbar-default navbar-fixed-bottom">
        <div class="container">
              <div class="navbar-collapse collapse" id="footer-body">
                  <ul class="nav navbar-nav">
               
                  </ul>
              </div>
          </div>
      </div>
   </footer> 
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  </body>
</html>
